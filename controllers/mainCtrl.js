(function() {  
  function MainCtrl (ENV, $http, Utils) {
    var vm = this;

    $http({
      method: 'GET',
      url: 'https://api.solvebio.com/v1/datasets?access_token=' + ENV.accessToken + '&limit=100',
    })
    .then(function(response){
      vm.datasets = _.filter(response.data.data, {depository: 'BiomarkerBase'})
        .filter(function(dataset){return dataset.id < 180;});
    });

    // for offline use
    //vm.datasets = JSON.parse('[{ "id": 165, "class_name": "Dataset","title": "Analytes","name": "Analytes","full_name": "BiomarkerBase/1.0.0-2015-06-03/Analytes","description": "Analytes","url": "https://api.solvebio.com/v1/datasets/165","created_at": "2015-06-11T22:40:22Z","updated_at": "2015-06-11T22:50:11.138Z","imports_url": "https://api.solvebio.com/v1/datasets/165/imports","exports_url": "https://api.solvebio.com/v1/datasets/165/exports","commits_url": "https://api.solvebio.com/v1/datasets/165/commits","template_url": "https://api.solvebio.com/v1/datasets/165/template","snapshots_url": "https://api.solvebio.com/v1/datasets/165/snapshots","fields_url": "https://api.solvebio.com/v1/datasets/165/fields","data_url": "https://api.solvebio.com/v1/datasets/165/data","depository": "BiomarkerBase","depository_id": 244,"depository_version": "BiomarkerBase/1.0.0-2015-06-03","depository_version_id": 89,"changelog_url": "https://api.solvebio.com/v1/datasets/165/changelog","beacon_url": "https://api.solvebio.com/v1/datasets/165/beacon","is_genomic": false,"genome_builds": null,"documents_count": 12,"entity_type": null,"tags": []},{"id": 166,"class_name": "Dataset","title": "Assays","name": "Assays","full_name": "BiomarkerBase/1.0.0-2015-06-03/Assays","description": "Assays","url": "https://api.solvebio.com/v1/datasets/166","created_at": "2015-06-11T22:40:23Z","updated_at": "2015-06-11T22:50:11.141Z","imports_url": "https://api.solvebio.com/v1/datasets/166/imports","exports_url": "https://api.solvebio.com/v1/datasets/166/exports","commits_url": "https://api.solvebio.com/v1/datasets/166/commits","template_url": "https://api.solvebio.com/v1/datasets/166/template","snapshots_url": "https://api.solvebio.com/v1/datasets/166/snapshots","fields_url": "https://api.solvebio.com/v1/datasets/166/fields","data_url": "https://api.solvebio.com/v1/datasets/166/data","depository": "BiomarkerBase","depository_id": 244,"depository_version": "BiomarkerBase/1.0.0-2015-06-03","depository_version_id": 89,"changelog_url": "https://api.solvebio.com/v1/datasets/166/changelog","beacon_url": "https://api.solvebio.com/v1/datasets/166/beacon","is_genomic": false,"genome_builds": null,"documents_count": 35,"entity_type": null,"tags": []},{"id": 167,"class_name": "Dataset","title": "Biomarkers","name": "Biomarkers","full_name": "BiomarkerBase/1.0.0-2015-06-03/Biomarkers","description": "Biomarkers","url": "https://api.solvebio.com/v1/datasets/167","created_at": "2015-06-11T22:40:24Z","updated_at": "2015-06-11T22:50:11.145Z","imports_url": "https://api.solvebio.com/v1/datasets/167/imports","exports_url": "https://api.solvebio.com/v1/datasets/167/exports","commits_url": "https://api.solvebio.com/v1/datasets/167/commits","template_url": "https://api.solvebio.com/v1/datasets/167/template","snapshots_url": "https://api.solvebio.com/v1/datasets/167/snapshots","fields_url": "https://api.solvebio.com/v1/datasets/167/fields","data_url": "https://api.solvebio.com/v1/datasets/167/data","depository": "BiomarkerBase","depository_id": 244,"depository_version": "BiomarkerBase/1.0.0-2015-06-03","depository_version_id": 89,"changelog_url": "https://api.solvebio.com/v1/datasets/167/changelog","beacon_url": "https://api.solvebio.com/v1/datasets/167/beacon","is_genomic": false,"genome_builds": null,"documents_count": 4235,"entity_type": null,"tags": []},{"id": 168,"class_name": "Dataset","title": "Companies","name": "Companies","full_name": "BiomarkerBase/1.0.0-2015-06-03/Companies","description": "Companies","url": "https://api.solvebio.com/v1/datasets/168","created_at": "2015-06-11T22:40:25Z","updated_at": "2015-06-11T22:50:11.149Z","imports_url": "https://api.solvebio.com/v1/datasets/168/imports","exports_url": "https://api.solvebio.com/v1/datasets/168/exports","commits_url": "https://api.solvebio.com/v1/datasets/168/commits","template_url": "https://api.solvebio.com/v1/datasets/168/template","snapshots_url": "https://api.solvebio.com/v1/datasets/168/snapshots","fields_url": "https://api.solvebio.com/v1/datasets/168/fields","data_url": "https://api.solvebio.com/v1/datasets/168/data","depository": "BiomarkerBase","depository_id": 244,"depository_version": "BiomarkerBase/1.0.0-2015-06-03","depository_version_id": 89,"changelog_url": "https://api.solvebio.com/v1/datasets/168/changelog","beacon_url": "https://api.solvebio.com/v1/datasets/168/beacon","is_genomic": false,"genome_builds": null,"documents_count": 654,"entity_type": null,"tags": []},{"id": 169,"class_name": "Dataset","title": "Diseases","name": "Diseases","full_name": "BiomarkerBase/1.0.0-2015-06-03/Diseases","description": "Diseases","url": "https://api.solvebio.com/v1/datasets/169","created_at": "2015-06-11T22:40:26Z","updated_at": "2015-06-11T22:50:11.152Z","imports_url": "https://api.solvebio.com/v1/datasets/169/imports","exports_url": "https://api.solvebio.com/v1/datasets/169/exports","commits_url": "https://api.solvebio.com/v1/datasets/169/commits","template_url": "https://api.solvebio.com/v1/datasets/169/template","snapshots_url": "https://api.solvebio.com/v1/datasets/169/snapshots","fields_url": "https://api.solvebio.com/v1/datasets/169/fields","data_url": "https://api.solvebio.com/v1/datasets/169/data","depository": "BiomarkerBase","depository_id": 244,"depository_version": "BiomarkerBase/1.0.0-2015-06-03","depository_version_id": 89,"changelog_url": "https://api.solvebio.com/v1/datasets/169/changelog","beacon_url": "https://api.solvebio.com/v1/datasets/169/beacon","is_genomic": false,"genome_builds": null,"documents_count": 365,"entity_type": null,"tags": []},{"id": 170,"class_name": "Dataset","title": "Drugs","name": "Drugs","full_name": "BiomarkerBase/1.0.0-2015-06-03/Drugs","description": "Drugs","url": "https://api.solvebio.com/v1/datasets/170","created_at": "2015-06-11T22:40:26Z","updated_at": "2015-06-11T22:50:11.156Z","imports_url": "https://api.solvebio.com/v1/datasets/170/imports","exports_url": "https://api.solvebio.com/v1/datasets/170/exports","commits_url": "https://api.solvebio.com/v1/datasets/170/commits","template_url": "https://api.solvebio.com/v1/datasets/170/template","snapshots_url": "https://api.solvebio.com/v1/datasets/170/snapshots","fields_url": "https://api.solvebio.com/v1/datasets/170/fields","data_url": "https://api.solvebio.com/v1/datasets/170/data","depository": "BiomarkerBase","depository_id": 244,"depository_version": "BiomarkerBase/1.0.0-2015-06-03","depository_version_id": 89,"changelog_url": "https://api.solvebio.com/v1/datasets/170/changelog","beacon_url": "https://api.solvebio.com/v1/datasets/170/beacon","is_genomic": false,"genome_builds": null,"documents_count": 624,"entity_type": null,"tags": []},{"id": 171,"class_name": "Dataset","title": "FDATests","name": "FDATests","full_name": "BiomarkerBase/1.0.0-2015-06-03/FDATests","description": "FDA approved tests","url": "https://api.solvebio.com/v1/datasets/171","created_at": "2015-06-11T22:40:27Z","updated_at": "2015-06-11T22:50:11.160Z","imports_url": "https://api.solvebio.com/v1/datasets/171/imports","exports_url": "https://api.solvebio.com/v1/datasets/171/exports","commits_url": "https://api.solvebio.com/v1/datasets/171/commits","template_url": "https://api.solvebio.com/v1/datasets/171/template","snapshots_url": "https://api.solvebio.com/v1/datasets/171/snapshots","fields_url": "https://api.solvebio.com/v1/datasets/171/fields","data_url": "https://api.solvebio.com/v1/datasets/171/data","depository": "BiomarkerBase","depository_id": 244,"depository_version": "BiomarkerBase/1.0.0-2015-06-03","depository_version_id": 89,"changelog_url": "https://api.solvebio.com/v1/datasets/171/changelog","beacon_url": "https://api.solvebio.com/v1/datasets/171/beacon","is_genomic": false,"genome_builds": null,"documents_count": 876,"entity_type": null,"tags": []},{"id": 172,"class_name": "Dataset","title": "LDTs","name": "LDTs","full_name": "BiomarkerBase/1.0.0-2015-06-03/LDTs","description": "Laboratory Developed Tests (LDTs)","url": "https://api.solvebio.com/v1/datasets/172","created_at": "2015-06-11T22:40:28Z","updated_at": "2015-06-11T22:50:11.163Z","imports_url": "https://api.solvebio.com/v1/datasets/172/imports","exports_url": "https://api.solvebio.com/v1/datasets/172/exports","commits_url": "https://api.solvebio.com/v1/datasets/172/commits","template_url": "https://api.solvebio.com/v1/datasets/172/template","snapshots_url": "https://api.solvebio.com/v1/datasets/172/snapshots","fields_url": "https://api.solvebio.com/v1/datasets/172/fields","data_url": "https://api.solvebio.com/v1/datasets/172/data","depository": "BiomarkerBase","depository_id": 244,"depository_version": "BiomarkerBase/1.0.0-2015-06-03","depository_version_id": 89,"changelog_url": "https://api.solvebio.com/v1/datasets/172/changelog","beacon_url": "https://api.solvebio.com/v1/datasets/172/beacon","is_genomic": false,"genome_builds": null,"documents_count": 735,"entity_type": null,"tags": []},{"id": 173,"class_name": "Dataset","title": "Publications","name": "Publications","full_name": "BiomarkerBase/1.0.0-2015-06-03/Publications","description": "Publications","url": "https://api.solvebio.com/v1/datasets/173","created_at": "2015-06-11T22:40:29Z","updated_at": "2015-06-11T22:50:11.167Z","imports_url": "https://api.solvebio.com/v1/datasets/173/imports","exports_url": "https://api.solvebio.com/v1/datasets/173/exports","commits_url": "https://api.solvebio.com/v1/datasets/173/commits","template_url": "https://api.solvebio.com/v1/datasets/173/template","snapshots_url": "https://api.solvebio.com/v1/datasets/173/snapshots","fields_url": "https://api.solvebio.com/v1/datasets/173/fields","data_url": "https://api.solvebio.com/v1/datasets/173/data","depository": "BiomarkerBase","depository_id": 244,"depository_version": "BiomarkerBase/1.0.0-2015-06-03","depository_version_id": 89,"changelog_url": "https://api.solvebio.com/v1/datasets/173/changelog","beacon_url": "https://api.solvebio.com/v1/datasets/173/beacon","is_genomic": false,"genome_builds": null,"documents_count": 23883,"entity_type": null,"tags": []},{"id": 174,"class_name": "Dataset","title": "Targets","name": "Targets","full_name": "BiomarkerBase/1.0.0-2015-06-03/Targets","description": "Targets","url": "https://api.solvebio.com/v1/datasets/174","created_at": "2015-06-11T22:40:30Z","updated_at": "2015-06-11T22:50:11.170Z","imports_url": "https://api.solvebio.com/v1/datasets/174/imports","exports_url": "https://api.solvebio.com/v1/datasets/174/exports","commits_url": "https://api.solvebio.com/v1/datasets/174/commits","template_url": "https://api.solvebio.com/v1/datasets/174/template","snapshots_url": "https://api.solvebio.com/v1/datasets/174/snapshots","fields_url": "https://api.solvebio.com/v1/datasets/174/fields","data_url": "https://api.solvebio.com/v1/datasets/174/data","depository": "BiomarkerBase","depository_id": 244,"depository_version": "BiomarkerBase/1.0.0-2015-06-03","depository_version_id": 89,"changelog_url": "https://api.solvebio.com/v1/datasets/174/changelog","beacon_url": "https://api.solvebio.com/v1/datasets/174/beacon","is_genomic": false,"genome_builds": null,"documents_count": 1287,"entity_type": null,"tags": []},{"id": 175,"class_name": "Dataset","title": "TherapeuticAreas","name": "TherapeuticAreas","full_name": "BiomarkerBase/1.0.0-2015-06-03/TherapeuticAreas","description": "Therapeutic areas","url": "https://api.solvebio.com/v1/datasets/175","created_at": "2015-06-11T22:40:31Z","updated_at": "2015-06-11T22:50:11.174Z","imports_url": "https://api.solvebio.com/v1/datasets/175/imports","exports_url": "https://api.solvebio.com/v1/datasets/175/exports","commits_url": "https://api.solvebio.com/v1/datasets/175/commits","template_url": "https://api.solvebio.com/v1/datasets/175/template","snapshots_url": "https://api.solvebio.com/v1/datasets/175/snapshots","fields_url": "https://api.solvebio.com/v1/datasets/175/fields","data_url": "https://api.solvebio.com/v1/datasets/175/data","depository": "BiomarkerBase","depository_id": 244,"depository_version": "BiomarkerBase/1.0.0-2015-06-03","depository_version_id": 89,"changelog_url": "https://api.solvebio.com/v1/datasets/175/changelog","beacon_url": "https://api.solvebio.com/v1/datasets/175/beacon","is_genomic": false,"genome_builds": null,"documents_count": 19,"entity_type": null,"tags": []},{"id": 176,"class_name": "Dataset","title": "Trials","name": "Trials","full_name": "BiomarkerBase/1.0.0-2015-06-03/Trials","description": "Clinical trials","url": "https://api.solvebio.com/v1/datasets/176","created_at": "2015-06-11T22:40:31Z","updated_at": "2015-06-11T22:50:11.177Z","imports_url": "https://api.solvebio.com/v1/datasets/176/imports","exports_url": "https://api.solvebio.com/v1/datasets/176/exports","commits_url": "https://api.solvebio.com/v1/datasets/176/commits","template_url": "https://api.solvebio.com/v1/datasets/176/template","snapshots_url": "https://api.solvebio.com/v1/datasets/176/snapshots","fields_url": "https://api.solvebio.com/v1/datasets/176/fields","data_url": "https://api.solvebio.com/v1/datasets/176/data","depository": "BiomarkerBase","depository_id": 244,"depository_version": "BiomarkerBase/1.0.0-2015-06-03","depository_version_id": 89,"changelog_url": "https://api.solvebio.com/v1/datasets/176/changelog","beacon_url": "https://api.solvebio.com/v1/datasets/176/beacon","is_genomic": false,"genome_builds": null,"documents_count": 994,"entity_type": null,"tags": []}]');

    vm.setDataset = function(selectedDataset){
      Utils.setDataset(selectedDataset);
    }


  }

  angular.module('app').controller('MainCtrl', ['ENV', '$http', 'Utils', MainCtrl]);
})();
